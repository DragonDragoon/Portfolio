<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_tqub28b2d43l-8>li:before{content:"\0025a0  "}ul.lst-kix_t57lgrbgh9pg-3{list-style-type:none}.lst-kix_x5em7yvbht31-8>li:before{content:"\0025a0  "}ul.lst-kix_t57lgrbgh9pg-4{list-style-type:none}ul.lst-kix_t57lgrbgh9pg-5{list-style-type:none}ul.lst-kix_t57lgrbgh9pg-6{list-style-type:none}ul.lst-kix_w8ragj2mcize-0{list-style-type:none}.lst-kix_tqub28b2d43l-6>li:before{content:"\0025cf  "}ul.lst-kix_t57lgrbgh9pg-7{list-style-type:none}ul.lst-kix_w8ragj2mcize-1{list-style-type:none}.lst-kix_x5em7yvbht31-7>li:before{content:"\0025cb  "}ul.lst-kix_t57lgrbgh9pg-8{list-style-type:none}.lst-kix_tqub28b2d43l-5>li:before{content:"\0025a0  "}.lst-kix_tqub28b2d43l-4>li:before{content:"\0025cb  "}ul.lst-kix_tqub28b2d43l-7{list-style-type:none}ul.lst-kix_tqub28b2d43l-6{list-style-type:none}ul.lst-kix_x5em7yvbht31-8{list-style-type:none}ul.lst-kix_tqub28b2d43l-5{list-style-type:none}ul.lst-kix_tqub28b2d43l-4{list-style-type:none}ul.lst-kix_tqub28b2d43l-3{list-style-type:none}ul.lst-kix_x5em7yvbht31-5{list-style-type:none}ul.lst-kix_tqub28b2d43l-2{list-style-type:none}.lst-kix_x5em7yvbht31-2>li:before{content:"\0025a0  "}ul.lst-kix_x5em7yvbht31-4{list-style-type:none}ul.lst-kix_tqub28b2d43l-1{list-style-type:none}.lst-kix_tqub28b2d43l-3>li:before{content:"\0025cf  "}ul.lst-kix_x5em7yvbht31-7{list-style-type:none}ul.lst-kix_tqub28b2d43l-0{list-style-type:none}ul.lst-kix_x5em7yvbht31-6{list-style-type:none}.lst-kix_tqub28b2d43l-0>li:before{content:"\0025cf  "}.lst-kix_tqub28b2d43l-1>li:before{content:"\0025cb  "}.lst-kix_tqub28b2d43l-2>li:before{content:"\0025a0  "}.lst-kix_x5em7yvbht31-3>li:before{content:"\0025cf  "}ul.lst-kix_tqub28b2d43l-8{list-style-type:none}.lst-kix_x5em7yvbht31-4>li:before{content:"\0025cb  "}.lst-kix_x5em7yvbht31-5>li:before{content:"\0025a0  "}.lst-kix_t57lgrbgh9pg-2>li:before{content:"\0025a0  "}.lst-kix_x5em7yvbht31-6>li:before{content:"\0025cf  "}ul.lst-kix_t57lgrbgh9pg-0{list-style-type:none}ul.lst-kix_t57lgrbgh9pg-1{list-style-type:none}ul.lst-kix_t57lgrbgh9pg-2{list-style-type:none}.lst-kix_t57lgrbgh9pg-3>li:before{content:"\0025cf  "}.lst-kix_w8ragj2mcize-4>li:before{content:"\0025cb  "}.lst-kix_w8ragj2mcize-3>li:before{content:"\0025cf  "}.lst-kix_w8ragj2mcize-5>li:before{content:"\0025a0  "}.lst-kix_t57lgrbgh9pg-4>li:before{content:"\0025cb  "}.lst-kix_t57lgrbgh9pg-6>li:before{content:"\0025cf  "}.lst-kix_t57lgrbgh9pg-5>li:before{content:"\0025a0  "}.lst-kix_w8ragj2mcize-0>li:before{content:"\0025cf  "}.lst-kix_w8ragj2mcize-8>li:before{content:"\0025a0  "}.lst-kix_w8ragj2mcize-7>li:before{content:"\0025cb  "}.lst-kix_t57lgrbgh9pg-8>li:before{content:"\0025a0  "}.lst-kix_w8ragj2mcize-6>li:before{content:"\0025cf  "}.lst-kix_t57lgrbgh9pg-7>li:before{content:"\0025cb  "}ul.lst-kix_w8ragj2mcize-4{list-style-type:none}ul.lst-kix_w8ragj2mcize-5{list-style-type:none}.lst-kix_w8ragj2mcize-1>li:before{content:"\0025cb  "}ul.lst-kix_w8ragj2mcize-2{list-style-type:none}ul.lst-kix_w8ragj2mcize-3{list-style-type:none}.lst-kix_w8ragj2mcize-2>li:before{content:"\0025a0  "}ul.lst-kix_w8ragj2mcize-8{list-style-type:none}ul.lst-kix_w8ragj2mcize-6{list-style-type:none}ul.lst-kix_w8ragj2mcize-7{list-style-type:none}.lst-kix_t57lgrbgh9pg-1>li:before{content:"\0025cb  "}.lst-kix_t57lgrbgh9pg-0>li:before{content:"\0025cf  "}ul.lst-kix_x5em7yvbht31-1{list-style-type:none}.lst-kix_x5em7yvbht31-0>li:before{content:"\0025cf  "}ul.lst-kix_x5em7yvbht31-0{list-style-type:none}.lst-kix_x5em7yvbht31-1>li:before{content:"\0025cb  "}ul.lst-kix_x5em7yvbht31-3{list-style-type:none}ul.lst-kix_x5em7yvbht31-2{list-style-type:none}.lst-kix_tqub28b2d43l-7>li:before{content:"\0025cb  "}ol{margin:0;padding:0}table td,table th{padding:0}.c43{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#ffffff;border-top-width:1pt;border-right-width:1pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;background-color:#efefef;border-left-style:solid;border-bottom-width:1pt;width:28.5pt;border-top-color:#ffffff;border-bottom-style:solid}.c39{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#ffffff;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#ffffff;border-left-width:1pt;border-top-style:solid;background-color:#d9d9d9;border-left-style:solid;border-bottom-width:1pt;width:400.5pt;border-top-color:#ffffff;border-bottom-style:solid}.c15{border-right-style:solid;border-bottom-color:#ffffff;border-top-width:1pt;border-right-width:1pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:18pt;border-top-color:#ffffff;border-bottom-style:solid}.c5{border-right-style:solid;border-bottom-color:#ffffff;border-top-width:1pt;border-right-width:1pt;border-left-color:#ffffff;vertical-align:top;border-right-color:#ffffff;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:449.2pt;border-top-color:#ffffff;border-bottom-style:solid}.c2{color:#000000;font-weight:normal;text-decoration:none;vertical-align:baseline;font-size:8pt;font-family:"Courier New";font-style:normal}.c1{color:#000000;font-weight:normal;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c36{margin-left:auto;border-spacing:0;border-collapse:collapse;margin-right:auto}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c9{border-spacing:0;border-collapse:collapse;margin-right:auto}.c14{background-color:#ffffff;font-size:10pt;font-family:"Courier New";color:#500050}.c20{font-weight:normal;text-decoration:none;vertical-align:baseline;font-style:italic}.c12{font-weight:normal;text-decoration:none;vertical-align:baseline;font-style:normal}.c35{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c22{padding-top:0pt;padding-bottom:0pt;line-height:2.0;text-align:left}.c11{background-color:#ffffff;font-size:10pt;font-family:"Courier New";color:#222222}.c16{font-size:9pt;font-family:"Times New Roman";font-weight:bold}.c17{color:#000000;font-size:10pt;font-family:"Courier New"}.c13{font-size:9pt;font-family:"Times New Roman";color:#222222}.c4{font-size:12pt;font-family:"Times New Roman";font-weight:bold}.c3{font-size:12pt;font-family:"Courier New"}.c6{font-size:12pt;font-family:"Times New Roman"}.c26{color:inherit;text-decoration:inherit}.c41{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c30{font-size:9pt;font-family:"Times New Roman"}.c24{border:1px solid black;margin:5px}.c7{orphans:2;widows:2}.c32{height:115pt}.c40{height:220pt}.c33{text-align:center}.c29{vertical-align:super}.c25{background-color:#f9f9f9}.c38{height:140pt}.c42{height:92pt}.c23{font-style:italic}.c31{text-indent:36pt}.c19{color:#000000}.c37{color:#222222}.c18{background-color:#ffffff}.c34{height:73pt}.c8{color:#333333}.c27{height:0pt}.c28{line-height:1.3636363636363635}.c10{height:11pt}.c21{height:227pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c18 c41"><p class="c7 c33"><span class="c4">ITCS 4102/5102 Course Project Part 3</span><sup><a href="#cmnt1" id="cmnt_ref1">[a]</a></sup><sup><a href="#cmnt2" id="cmnt_ref2">[b]</a></sup><sup><a href="#cmnt3" id="cmnt_ref3">[c]</a></sup><sup><a href="#cmnt4" id="cmnt_ref4">[d]</a></sup><sup><a href="#cmnt5" id="cmnt_ref5">[e]</a></sup></p><p class="c7 c33 c10"><span class="c4"></span></p><p class="c7"><span class="c4">Team members</span><span class="c6">: Yuhan Zhang &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 800913294 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Bryron Ho &nbsp;800759319</span></p><p class="c7"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; William Woodard &nbsp; &nbsp;800746586 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c7"><span class="c4">Language</span><span class="c6">:Lua</span></p><p class="c7"><span class="c4">Program</span><span class="c6">: Advanced Calculator</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c4">Objective And Analysis</span><sup><a href="#cmnt6" id="cmnt_ref6">[f]</a></sup><sup><a href="#cmnt7" id="cmnt_ref7">[g]</a></sup><sup><a href="#cmnt8" id="cmnt_ref8">[h]</a></sup><sup><a href="#cmnt9" id="cmnt_ref9">[i]</a></sup><sup><a href="#cmnt10" id="cmnt_ref10">[j]</a></sup><sup><a href="#cmnt11" id="cmnt_ref11">[k]</a></sup><sup><a href="#cmnt12" id="cmnt_ref12">[l]</a></sup><sup><a href="#cmnt13" id="cmnt_ref13">[m]</a></sup><sup><a href="#cmnt14" id="cmnt_ref14">[n]</a></sup><sup><a href="#cmnt15" id="cmnt_ref15">[o]</a></sup><sup><a href="#cmnt16" id="cmnt_ref16">[p]</a></sup><sup><a href="#cmnt17" id="cmnt_ref17">[q]</a></sup><sup><a href="#cmnt18" id="cmnt_ref18">[r]</a></sup></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c6">The objective of this program was to create a program that can evaluate string mathematically. In other words, this program is a calculator that takes a string (a user-given expression) and evaluates it using a number theory expression rule-set to provide a mathematically sound result. The calculator is also supposed to be able to perform basic functions on input data. This is essentially the creation of a language.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c6">To create our language for evaluation, we must have the ability to parse an expression in the order we wish it to be. To satisfy this program&rsquo;s objects, this means that the parser is to convert the user input into an evaluation that satisfies the simple arithmetic rules of mathematics. For example, the user may input the following string: &ldquo;1 + 2 * 3&rdquo;. The simplest method of evaluating this string would be to start from the left and evaluate to the right, but does this create a mathematically sound result?</span></p><p class="c7 c10"><span class="c6"></span></p><a id="t.8d7fdaa75f770ab449aecab1067d45eb719db34f"></a><a id="t.0"></a><table class="c9"><tbody><tr class="c34"><td class="c15" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.rgdvuluseuij"></a><span class="c12 c6 c19">&nbsp;</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.f3j6bc6vj42n"></a><img src="images/image00.png"></p><p class="c0 c7"><a id="h.qc8ymm7261v5"></a><span class="c6">&nbsp; &nbsp; &nbsp;</span><img src="images/image01.png"></p><p class="c0 c7"><a id="h.2nl3baqt4uj9"></a><span class="c6">&nbsp; &nbsp; &nbsp;</span><img src="images/image02.png"></p><p class="c0 c7"><a id="h.6c74zp3fenm1"></a><span class="c6">&nbsp; &nbsp; &nbsp;</span><img src="images/image03.png"><span class="c12 c6 c19">.</span></p><p class="c22 c7"><a id="h.rgdvuluseuij"></a><span class="c16">Figure 1</span><span class="c30">&mdash;Left-to-right evaluation of 1 + 2 * 3</span></p></td></tr></tbody></table><p class="c7"><span class="c6">To the average observer, </span><span class="c4">Figure 1</span><span class="c6">&nbsp;is obviously incorrect. This is due to an order of operations required in a mathematical evaluation, or in computer science terms, a grammar. This grammar represents an order through which we can correctly evaluate this expression. The order of operations, grammar, in mathematics is something widely known:</span></p><p class="c7 c10"><span class="c6"></span></p><a id="t.39e3e9456142860666fbd408da828de0cad774ab"></a><a id="t.1"></a><table class="c9"><tbody><tr class="c32"><td class="c15" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.rgdvuluseuij"></a><span class="c12 c6 c19">&nbsp;</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.cx2gzajzofoa"></a><span class="c11">1) P </span><img src="images/image04.png"><span class="c11">&nbsp;Parenthesis &nbsp; &nbsp;</span><img src="images/image04.png"><span class="c12 c11">&nbsp;()</span></p><p class="c0 c7"><a id="h.k5z6jhfzdv6n"></a><span class="c11">2) E </span><img src="images/image04.png"><span class="c11">&nbsp;Exponential &nbsp; &nbsp;</span><img src="images/image04.png"><span class="c12 c11">&nbsp;^</span></p><p class="c0 c7"><a id="h.kzt9wqp6aftu"></a><span class="c11">3) M </span><img src="images/image04.png"><span class="c11">&nbsp;Multiplication </span><img src="images/image04.png"><span class="c12 c11">&nbsp;*</span></p><p class="c0 c7"><a id="h.42ionxzi37be"></a><span class="c11">3) D </span><img src="images/image04.png"><span class="c11">&nbsp;Division &nbsp; &nbsp; &nbsp; </span><img src="images/image04.png"><span class="c11 c12">&nbsp;/</span></p><p class="c0 c7"><a id="h.pcrmc7dwy58u"></a><span class="c11">4) A </span><img src="images/image04.png"><span class="c11">&nbsp;Addition &nbsp; &nbsp; &nbsp; </span><img src="images/image04.png"><span class="c12 c11">&nbsp;+</span></p><p class="c0 c7"><a id="h.79xs9f2qo2uu"></a><span class="c11">4) S </span><img src="images/image04.png"><span class="c11">&nbsp;Subtraction &nbsp; &nbsp;</span><img src="images/image04.png"><span class="c12 c11">&nbsp;-</span></p><p class="c22 c7"><a id="h.rgdvuluseuij"></a><span class="c16 c37">Figure 2</span><span class="c13">&mdash;PEMDAS</span></p></td></tr></tbody></table><p class="c7"><span class="c6">The order of operations, PEMDAS, given in </span><span class="c4">Figure 2</span><span class="c6">&nbsp;are from what is evaluated first, 1, to what is evaluated last, 4. This gives a specific order for each operation, ensuring that the position of the operator in the statement is not determinant of the result; the operators are well-defined in evaluation. This grammar is not enough to satisfy our objective, such as functions, so we must extend it. The grammar we used in our calculator was as follows:</span></p><p class="c7 c10"><span class="c6"></span></p><a id="t.ddc63d6809b9e381b23b6b7dd00a3b39df5c65ee"></a><a id="t.2"></a><table class="c9"><tbody><tr class="c38"><td class="c15" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.rgdvuluseuij"></a><span class="c12 c6 c19">&nbsp;</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.2jmf4k87qxby"></a><span class="c14">Expression </span><img src="images/image04.png"><span class="c14 c12">&nbsp;Term { ( &quot;+&quot; | &quot;-&quot; ) Expression }</span></p><p class="c0 c7"><a id="h.qrrwkrinch4e"></a><span class="c14">Term </span><img src="images/image04.png"><span class="c14 c12">&nbsp;Factor { ( &quot;*&quot; | &quot;/&quot; ) Term }</span></p><p class="c0 c7"><a id="h.9ddz4oedck3s"></a><span class="c14">Factor </span><img src="images/image04.png"><span class="c14 c12">&nbsp;Bracket { &quot;^&quot; Factor }</span></p><p class="c0 c7"><a id="h.g7ij0pda9txc"></a><span class="c11">Bracket </span><img src="images/image04.png"><span class="c11">&nbsp;[ Word ] &quot;(&quot; Expression [ </span><span class="c14">&quot;,&quot; Expression</span><span class="c12 c11">&nbsp;] &quot;)&quot; | Word | Number</span></p><p class="c0 c7"><a id="h.qc8ymm7261v5"></a><span class="c14">Word </span><img src="images/image04.png"><span class="c14 c12">&nbsp;Letter { Letter }</span></p><p class="c0 c7"><a id="h.c169anadqfy5"></a><span class="c14">Letter </span><img src="images/image04.png"><span class="c14 c12">&nbsp;&quot;a&quot; - &quot;z&quot; | &quot;A&quot; - &quot;Z&quot; | &quot;_&quot;</span></p><p class="c0 c7"><a id="h.y1yxz5oduvuw"></a><span class="c14">Number </span><img src="images/image04.png"><span class="c14 c12">&nbsp;[ &quot;-&quot; ] Digit { Digit } [ &quot;.&quot; Digit { Digit } ]</span></p><p class="c0 c7"><a id="h.79xs9f2qo2uu"></a><span class="c14">Digit </span><img src="images/image04.png"><span class="c14">&nbsp;&quot;0 - &quot;9&quot;</span></p><p class="c7 c22"><a id="h.rgdvuluseuij"></a><span class="c16">Figure 3</span><span class="c30">&mdash;EBNF of Calculator Grammar</span></p></td></tr></tbody></table><p class="c7"><span class="c6">The grammar used in the calculator is much more extended than what was practiced in class. To satisfy the objective of the program, it must account for constants (which can be words), functions (which is a word followed by parenthesis and arguments), numbers, addition, subtraction, multiplication, division, exponential, parentheses around expressions, and all the orders of PEMDAS. The grammar is converted to the following for code evaluation using the Lua library LPeg:</span></p><p class="c7 c10"><span class="c6"></span></p><a id="t.97f7d081adb6be0bc1961a67e338dfce8b494fa7"></a><a id="t.3"></a><table class="c9"><tbody><tr class="c40"><td class="c15" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.rgdvuluseuij"></a><span class="c12 c6 c19">&nbsp;</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.m783rqp32y"></a><span class="c6 c19 c20">From Project_Part_3/lib/calculator.lua...</span></p><a id="t.1293ac1a8e689dec1b2e9ae6885a91727c6f4883"></a><a id="t.4"></a><table class="c36"><tbody><tr class="c27"><td class="c43" colspan="1" rowspan="1"><p class="c0"><span class="c2">49</span></p><p class="c0"><span class="c2">50</span></p><p class="c0 c10"><span class="c2"></span></p><p class="c0"><span class="c2">51</span></p><p class="c0 c10"><span class="c2"></span></p><p class="c0"><span class="c2">52</span></p><p class="c0 c10"><span class="c2"></span></p><p class="c0"><span class="c2">53</span></p><p class="c0 c10"><span class="c2"></span></p><p class="c0 c10"><span class="c2"></span></p><p class="c0 c10"><span class="c2"></span></p><p class="c0"><span class="c2">54</span></p><p class="c0"><span class="c2">55</span></p><p class="c0"><span class="c2">56</span></p><p class="c0 c10"><span class="c2"></span></p><p class="c0"><span class="c2">57</span></p><p class="c0"><span class="c2">58</span></p></td><td class="c39" colspan="1" rowspan="1"><p class="c0"><span class="c2">Grammar = lpeg.P({ &quot;Expression&quot;,</span></p><p class="c0"><span class="c2">&nbsp; Expression = tree_node(lpeg.V(&quot;Term&quot;) </span></p><p class="c0"><span class="c2">&nbsp; &nbsp; * lpeg.Cg(add_sub_op * lpeg.V(&quot;Expression&quot;))^0);</span></p><p class="c0"><span class="c2">&nbsp; Term = </span></p><p class="c0"><span class="c2">&nbsp; &nbsp; tree_node(lpeg.V(&quot;Factor&quot;) * lpeg.Cg(mul_div_op * lpeg.V(&quot;Term&quot;))^0);</span></p><p class="c0"><span class="c2">&nbsp; Factor = </span></p><p class="c0"><span class="c2">&nbsp; &nbsp; tree_node(lpeg.V(&quot;Bracket&quot;) * lpeg.Cg(pow_op * lpeg.V(&quot;Factor&quot;))^0);</span></p><p class="c0"><span class="c2">&nbsp; Bracket = </span></p><p class="c0"><span class="c2">&nbsp; &nbsp; tree_node(lpeg.V(&quot;Word&quot;)^-1 * par_open * lpeg.V(&quot;Expression&quot;) </span></p><p class="c0"><span class="c2">&nbsp; &nbsp; * (comma * lpeg.V(&quot;Expression&quot;))^-1 * par_close</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; + lpeg.V(&quot;Number&quot;) + lpeg.V(&quot;Word&quot;));</span></p><p class="c0"><span class="c2">&nbsp; Word = lpeg.C(lpeg.V(&quot;Letter&quot;)^1) * space / tostring;</span></p><p class="c0"><span class="c2">&nbsp; Letter = a_to_Z + underscore;</span></p><p class="c0"><span class="c2">&nbsp; Number = lpeg.C(negative^-1 * lpeg.V(&quot;Digit&quot;)^1 </span></p><p class="c0"><span class="c2">&nbsp; &nbsp; * (period^-1 * lpeg.V(&quot;Digit&quot;)^1)^0) * space / tonumber;</span></p><p class="c0"><span class="c2">&nbsp; Digit = zero_to_nine;</span></p><p class="c0"><span class="c2">})</span></p></td></tr></tbody></table><p class="c22 c7"><a id="h.rgdvuluseuij"></a><span class="c16">Figure 4</span><span class="c30">&mdash;Grammar object in calculator</span></p></td></tr></tbody></table><p class="c7"><span class="c4">Figure 4</span><span class="c6">&nbsp;looks very similar to the grammar given in </span><span class="c4">Figure 3</span><span class="c6">&nbsp;if observed close enough. This grammar takes our expression and makes a syntax tree, just as we did in class. Now our expression </span><span class="c6 c23">a</span><span class="c6">&nbsp;from </span><span class="c4">Figure 1</span><span class="c6">&nbsp;becomes so:</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c10"><span class="c6"></span></p><a id="t.19c629a987f2c96d21211333ef299a17b017f077"></a><a id="t.5"></a><table class="c9"><tbody><tr class="c21"><td class="c15" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.rgdvuluseuij"></a><span class="c12 c6 c19">&nbsp;</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c7 c35"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 465.00px; height: 255.00px;"><img alt="" src="images/image09.png" style="width: 465.00px; height: 255.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c22 c7"><a id="h.rgdvuluseuij"></a><span class="c16">Figure 5</span><span class="c30">&mdash;Parse tree of 1 + 2 * 3 using calculator grammar</span></p></td></tr></tbody></table><p class="c7"><span class="c6">Using a depth-ordered traversal of </span><span class="c4">Figure 4</span><span class="c6">, we can achieve our own order of operations, multiplying before adding, using exponentials before multiplying, et cetera, using our grammar. And finally, this leads us to the evaluation the calculator does:</span></p><p class="c7 c10"><span class="c6"></span></p><a id="t.f09fe755da6f74139d633ddf850892707f710ef3"></a><a id="t.6"></a><table class="c9"><tbody><tr class="c42"><td class="c15" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.rgdvuluseuij"></a><span class="c12 c6 c19">&nbsp;</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c0 c7"><a id="h.z8ggm3d99sx8"></a><img src="images/image05.png"></p><p class="c0 c7"><a id="h.qc8ymm7261v5"></a><span class="c6">&nbsp; &nbsp; &nbsp;</span><img src="images/image06.png"><span class="c12 c6 c19">&nbsp;</span></p><p class="c0 c7"><a id="h.2nl3baqt4uj9"></a><span class="c6">&nbsp; &nbsp; &nbsp;</span><img src="images/image07.png"></p><p class="c0 c7"><a id="h.6c74zp3fenm1"></a><span class="c6">&nbsp; &nbsp; &nbsp;</span><img src="images/image08.png"><span class="c12 c6 c19">.</span></p><p class="c22 c7"><a id="h.rgdvuluseuij"></a><span class="c16">Figure 6</span><span class="c30">&mdash;Calculator evaluation of 1 + 2 * 3</span></p></td></tr></tbody></table><p class="c7"><span class="c6">We have now told the computer how to evaluate the given user input. This grammar is the most important part of the program, as the computer does not know how to evaluate the given user input properly, and as such, we must tell it. This grammar leads us to have many interesting evaluations, such as expressions embedded in functions (</span><span class="c3">cos(-2 * pi)</span><span class="c6">), and boolean logic (</span><span class="c3">or_(true, false)</span><span class="c6">), and even lazy recursive evaluations (</span><span class="c3">prev(1) + prev(2)</span><span class="c6">). We have essentially created our own programming language!</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c6">=====================================================================</span></p><p class="c7"><span class="c4">Why Calculator?</span></p><p class="c7"><span class="c6">To implement a calculator is a good way to illustrate the features of Lua.</span></p><p class="c7 c10"><span class="c4"></span></p><p class="c7 c10"><span class="c4"></span></p><p class="c7"><span class="c4">Data Structures of Lua</span></p><p class="c7 c10"><span class="c4"></span></p><p class="c7"><span class="c4">Tables</span></p><p class="c7"><span class="c6">Tables are the most important data structures (and, by design, the only built-in composite data type) in Lua, and are the foundation of all user-created types. They are conceptually similar to associative arrays in PHP, dictionaries in Python and hashes in Ruby or Perl</span><span class="c4">.</span></p><p class="c7"><span class="c6">A table is a collection of key and data pairs, where the data is referenced by key; in other words, it&#39;s a</span><span class="c6"><a class="c26" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Hash_table&amp;sa=D&amp;ust=1455826295475000&amp;usg=AFQjCNFBDVZA1Rh1TIkZQGBm5uSDXmUhYQ">&nbsp;hashed</a></span><span class="c6"><a class="c26" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Heterogeneity&amp;sa=D&amp;ust=1455826295475000&amp;usg=AFQjCNF5iKXHhFLUUCH4A_iAXLP4UWndXw">&nbsp;heterogeneous</a></span><span class="c6">&nbsp;associative array. A key (index) can be any value but nil and</span><span class="c6"><a class="c26" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/NaN&amp;sa=D&amp;ust=1455826295475000&amp;usg=AFQjCNGuZzXeBFOWtEQkcedc17l62luuxA">&nbsp;NaN</a></span><span class="c6">. A numeric key of 1 is considered distinct from a string key of &quot;1&quot;.</span></p><p class="c7"><span class="c6">Tables are created using the </span><span class="c6 c25">{}</span><span class="c6">&nbsp;constructor syntax:</span></p><p class="c7"><span class="c3">a_table = {} -- Creates a new, empty table</span></p><p class="c7"><span class="c6">Tables are always passed by reference</span></p><p class="c7"><span class="c3">a_table = {x = 10} &nbsp;-- Creates a new table, with one entry mapping &quot;x&quot; to the number 10.</span></p><p class="c7"><span class="c3">print(a_table[&quot;x&quot;]) -- Prints the value associated with the string key, in this case 10.</span></p><p class="c7"><span class="c3">b_table = a_table</span></p><p class="c7"><span class="c3">b_table[&quot;x&quot;] = 20 &nbsp; -- The value in the table has been changed to 20.</span></p><p class="c7"><span class="c3">print(b_table[&quot;x&quot;]) -- Prints 20.</span></p><p class="c7"><span class="c3">print(a_table[&quot;x&quot;]) -- Also prints 20, because a_table and b_table both refer to the same table.</span></p><p class="c7 c10"><span class="c6 c25"></span></p><p class="c7"><span class="c4">As record</span></p><p class="c7"><span class="c6">A table is often used as structure (or record) by using strings as keys. Because such use is very common, Lua features a special syntax for accessing such fields. Example:</span></p><p class="c7"><span class="c3">point = { x = 10, y = 20 } &nbsp; -- Create new table</span></p><p class="c7"><span class="c3">print(point[&quot;x&quot;]) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-- Prints 10</span></p><p class="c7"><span class="c3">print(point.x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- Has exactly the same meaning as line above.</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-- The easier-to-read dot notation is just syntactic sugar.</span></p><p class="c7"><span class="c6">Quoting the Lua 5.1 Reference Manual:</span></p><p class="c7"><span class="c6">&quot;The syntax var.Name is just</span><span class="c6"><a class="c26" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Syntactic_sugar&amp;sa=D&amp;ust=1455826295479000&amp;usg=AFQjCNHiXad1ZlsZ8X2c0SFm1IIKLz6bzw">&nbsp;syntactic sugar</a></span><span class="c6">&nbsp;for var[&#39;Name&#39;];&quot;</span></p><p class="c7"><span class="c6">As namespace</span></p><p class="c7"><span class="c6">By using a table to store related functions, it can act as a namespace.</span></p><p class="c7"><span class="c3">Point = {}</span></p><p class="c7 c10"><span class="c3"></span></p><p class="c7"><span class="c3">Point.new = function(x, y)</span></p><p class="c7"><span class="c3">&nbsp; return {x = x, y = y} &nbsp;-- &nbsp;return {[&quot;x&quot;] = x, [&quot;y&quot;] = y}</span></p><p class="c7"><span class="c3">end</span></p><p class="c7 c10"><span class="c3"></span></p><p class="c7"><span class="c3">Point.set_x = function(point, x)</span></p><p class="c7"><span class="c3">&nbsp; point.x = x &nbsp;-- &nbsp;point[&quot;x&quot;] = x;</span></p><p class="c7"><span class="c3">end</span></p><p class="c7 c10"><span class="c6 c25"></span></p><p class="c7"><span class="c4">As array</span></p><p class="c7"><span class="c6">By using a numerical key, the table resembles an</span><span class="c6"><a class="c26" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Array_data_type&amp;sa=D&amp;ust=1455826295483000&amp;usg=AFQjCNG5rW4PpLPL6kVvcXr_6CnVy9xDCg">&nbsp;array data type</a></span><span class="c6">. Lua arrays are 1-based: the first index is 1 rather than 0 as it is for many other programming languages (though an explicit index of 0 is allowed).</span></p><p class="c7"><span class="c6">A simple array of strings:</span></p><p class="c7"><span class="c3">array = { &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot; } &nbsp; -- Indices are assigned automatically.</span></p><p class="c7"><span class="c3">print(array[2]) &nbsp; -- Prints &quot;b&quot;. Automatic indexing in Lua starts at 1.</span></p><p class="c7"><span class="c3">print(#array) &nbsp;-- Prints 4. &nbsp;# is the length operator for tables and strings.</span></p><p class="c7"><span class="c3">array[0] = &quot;z&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- Zero is a legal index.</span></p><p class="c7"><span class="c3">print(#array) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-- Still prints 4, as Lua arrays are 1-based.</span></p><p class="c7"><span class="c6">The length of a table t is defined to be any integer index n such that t[n] is not nil and t[n+1] is nil; moreover, if t[1] is nil, n can be zero. For a regular array, with non-nil values from 1 to a given n, its length is exactly that n, the index of its last value. If the array has &quot;holes&quot; (that is, nil values between other non-nil values), then #t can be any of the indices that directly precedes a nil value (that is, it may consider any such nil value as the end of the array).</span><span class="c6 c29">[7]</span></p><p class="c7"><span class="c6">A two dimensional table:</span></p><p class="c7"><span class="c3">ExampleTable = </span></p><p class="c7"><span class="c3">{</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; &nbsp;{1,2,3,4},</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; &nbsp;{5,6,7,8}</span></p><p class="c7"><span class="c3">} </span></p><p class="c7"><span class="c3">print(ExampleTable[1][3]) -- Prints &quot;3&quot;</span></p><p class="c7"><span class="c3">print(ExampleTable[2][4]) -- Prints &quot;8&quot;</span></p><p class="c7"><span class="c6">An array of objects:</span></p><p class="c7"><span class="c3">function Point(x, y) &nbsp; &nbsp; &nbsp; &nbsp;-- &quot;Point&quot; object constructor</span></p><p class="c7"><span class="c3">&nbsp; return { x = x, y = y } &nbsp; -- Creates and returns a new object (table)</span></p><p class="c7"><span class="c3">end</span></p><p class="c7"><span class="c3">array = { Point(10, 20), Point(30, 40), Point(50, 60) } -- Creates array of points</span></p><p class="c7"><span class="c3">-- array = { { x = 10, y = 20 }, { x = 30, y = 40 }, { x = 50, y = 60 } };</span></p><p class="c7"><span class="c3">print(array[2].y) -- Prints 40</span></p><p class="c7"><span class="c6">Using a hash map to emulate an array normally is slower than using an actual array; however, Lua tables are optimized for use as arrays to help avoid this issue.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c4">Functions</span></p><p class="c7"><span class="c6 c18">Functions are the main mechanism for abstraction of statements and expressions in Lua. Functions can both carry out a specific task (what is sometimes called </span><span class="c6 c23 c18">procedure</span><span class="c6 c18">&nbsp;or </span><span class="c6 c18 c23">subroutine</span><span class="c6 c18">&nbsp;in other languages) or compute and return values.</span></p><p class="c7"><span class="c6 c18">An unconventional, but quite convenient feature of Lua is that functions may return multiple results. Several predefined functions in Lua return multiple values</span></p><p class="c7"><span class="c6">Lua&#39;s treatment of functions as</span><span class="c6"><a class="c26" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/First-class_function&amp;sa=D&amp;ust=1455826295489000&amp;usg=AFQjCNFpZBg1zA7gxXy2_pklRnwdOxn5Ig">&nbsp;first-class</a></span><span class="c6">&nbsp;values is shown in the following example, where the print function&#39;s behavior is modified:</span></p><p class="c7"><span class="c3">do</span></p><p class="c7"><span class="c3">&nbsp; local oldprint = print</span></p><p class="c7"><span class="c3">&nbsp; -- Store current print function as oldprint</span></p><p class="c7"><span class="c3">&nbsp; function print(s)</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; --[[ Redefine print function, the usual print function can still be used </span></p><p class="c7"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;through oldprint. The new one has only one argument.]]</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; oldprint(s == &quot;foo&quot; and &quot;bar&quot; or s)</span></p><p class="c7"><span class="c3">&nbsp; end</span></p><p class="c7"><span class="c3">end</span></p><p class="c7"><span class="c6">Any future calls to print will now be routed through the new function, and because of Lua&#39;s lexical scoping, the old print function will only be accessible by the new, modified print.</span></p><p class="c7"><span class="c6">Lua also supports closures, as demonstrated below:</span></p><p class="c7"><span class="c3">function addto(x)</span></p><p class="c7"><span class="c3">&nbsp; -- Return a new function that adds x to the argument</span></p><p class="c7"><span class="c3">&nbsp; return function(y)</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; --[=[ When we refer to the variable x, which is outside of the current</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;scope and whose lifetime would be shorter than that of this anonymous</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;function, Lua creates a closure.]=]</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; return x + y</span></p><p class="c7"><span class="c3">&nbsp; end</span></p><p class="c7"><span class="c3">end</span></p><p class="c7"><span class="c3">fourplus = addto(4)</span></p><p class="c7"><span class="c3">print(fourplus(3)) &nbsp;-- Prints 7</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c3">--This can also be achieved by calling the function in the following way:</span></p><p class="c7"><span class="c3">print(addto(4)(3))</span></p><p class="c7"><span class="c3">--[[ This is because we are calling the returned function from `addto(4)&#39; with the argument `3&#39; directly.</span></p><p class="c7"><span class="c3">&nbsp; &nbsp; &nbsp;This also helps to reduce data cost and up performance if being called iteratively.</span></p><p class="c7"><span class="c3">]]</span></p><p class="c7"><span class="c6">A new closure for the variable x is created every time addto is called, so that each new anonymous function returned will always access its own x parameter. The closure is managed by Lua&#39;s garbage collector, just like any other object.</span></p><p class="c7"><span class="c6">&nbsp;</span></p><p class="c7"><span class="c4">Ints, Floats, Strings, Pointers</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7 c28"><span class="c6">Lua is a dynamically typed language. This means that variables do not have types; only values do. There are no type definitions in the language. All values carry their own type.All values in Lua are first-class values. This means that all values can be stored in variables, passed as arguments to other functions, and returned as results.</span></p><p class="c7 c28"><span class="c6">There are eight basic types in Lua: nil, boolean, number, string, function, userdata, thread, and table. Nil is the type of the value nil, whose main property is to be different from any other value; it usually represents the absence of a useful value. Boolean is the type of the values false and true. Both nil and false make a condition false; any other value makes it true. Number represents real (double-precision floating-point) numbers. Operations on numbers follow the same rules of the underlying C implementation. String represents immutable sequences of bytes. Lua is 8-bit clean: strings can contain any 8-bit value, including embedded zeros (&#39;\0&#39;).</span></p><p class="c7 c28"><span class="c6">Lua can call (and manipulate) functions written in Lua and functions written in C.</span></p><p class="c7 c28"><span class="c6">The type userdata is provided to allow arbitrary C data to be stored in Lua variables. A userdata value is a pointer to a block of raw memory. There are two kinds of userdata: full userdata, where the block of memory is managed by Lua, and light userdata, where the block of memory is managed by the host. Userdata has no predefined operations in Lua, except assignment and identity test. By using metatables, the programmer can define operations for full userdata values. Userdata values cannot be created or modified in Lua, only through the C API. This guarantees the integrity of data owned by the host program.</span></p><p class="c7 c28"><span class="c6">The type thread represents independent threads of execution and it is used to implement coroutines. &nbsp;Lua supports coroutines on all systems, even those that do not support threads.</span></p><p class="c7 c28"><span class="c6">The type table implements associative arrays, that is, arrays that can be indexed not only with numbers, but with any Lua value except nil and NaN. Tables can contain values of all types (except nil). Any key with value nil is not considered part of the table. Conversely, any key that is not part of a table has an associated value nil.</span></p><p class="c7 c28"><span class="c6">Tables are the sole data structuring mechanism in Lua; they can be used to represent ordinary arrays, sequences, symbol tables, sets, records, graphs, trees, etc. To represent records, Lua uses the field name as an index. The language supports this representation by providing a.name as syntactic sugar fora[&quot;name&quot;]. There are several convenient ways to create tables in Lua.</span></p><p class="c7 c28"><span class="c6">We use the term sequence to denote a table where the set of all positive numeric keys is equal to {1..n} for some integer n, which is called the length of the sequence.</span></p><p class="c7 c28"><span class="c6">Like indices, the values of table fields can be of any type. In particular, because functions are first-class values, table fields can contain functions. Thus tables can also carry methods.</span></p><p class="c7 c28"><span class="c6">The indexing of tables follows the definition of raw equality in the language. The expressions a[i] and a[j] denote the same table element if and only if iand j are raw equal (that is, equal without metamethods).</span></p><p class="c7 c28"><span class="c6">Tables, functions, threads, and (full) userdata values are objects: variables do not actually contain these values, only references to them. Assignment, parameter passing, and function returns always manipulate references to such values; these operations do not imply any kind of copy.</span></p><p class="c7 c28"><span class="c6">The library function </span><span class="c3">type</span><span class="c3">&nbsp;</span><span class="c6">returns a string describing the type of a given value.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c4">Exception Handling</span></p><p class="c7"><span class="c6">Lua has a built in function of Error Handling and Exceptions. The built in function of pcall() is used to catch any errors when a function runs and the error() function will output the error message to pcall(). The following code demonstrates how pcall should be used to catch an exception and output the error code. pcall() encapsulates any functions that run in it and will catch any errors while the functions run.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c3">function hello_world()</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(error) then</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error(&ldquo;error message&rdquo;) -- terminates the function call</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</span></p><p class="c7"><span class="c3">end</span></p><p class="c7 c10"><span class="c3"></span></p><p class="c7"><span class="c3">if(pcall(hello_world())) then</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- success, continue to do something</span></p><p class="c7"><span class="c3">else</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--error prints error message</span></p><p class="c7"><span class="c3">end</span></p><p class="c7 c10"><span class="c3"></span></p><p class="c7"><span class="c4">Concurrency</span></p><p class="c7"><span class="c6">Lua does not support concurrency natively, however using a third party library such as luaproc will enable Lua to support concurrency programming.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c4">Unique Syntax</span></p><p class="c7"><span class="c6">Lua does not need curly braces to contain the body of code. Instead of using semicolons to close or end a statement Lua uses &ldquo;end&rdquo; to indicate closing of functions, if statements or any other statements. semicolons to close an statements.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c3">function hello_world()</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isTrue) then</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;awesome()</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;liar()</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</span></p><p class="c7"><span class="c3">end</span></p><p class="c7 c10"><span class="c4"></span></p><p class="c7"><span class="c4">Unique Semantics</span></p><p class="c7"><span class="c6">Lua allows a function to be called without satisfying all the defined arguments.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c3">function hello_world(a,b,c,d)</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(a==nil or b==nil or c==nil or d==nil)then</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &ldquo;one or more of the arguments are empty.&rdquo;</span></p><p class="c7 c31"><span class="c3">else</span></p><p class="c7 c31"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c3">do_something</span></p><p class="c7"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</span></p><p class="c7"><span class="c3">end</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c6">print(hello_world(1,2))</span></p><p class="c7"><span class="c6">output: one or more of the arguments are empty.</span></p><p class="c7 c10"><span class="c6"></span></p><p class="c7"><span class="c6 c8">Lua supports </span><span class="c6 c8">short circuit evaluation </span><span class="c6 c8">as shown below which essentially allows an argument to be assigned to a variable only if it is not nil or else it can be set to a predefined value.</span></p><p class="c7 c10"><span class="c6 c8"></span></p><p class="c7"><span class="c3 c8">function hello_world(a,b,c)</span></p><p class="c7"><span class="c3 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local testA = a or &ldquo;defaultA&rdquo;</span></p><p class="c7"><span class="c3 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local testB = b or &nbsp;5</span></p><p class="c7"><span class="c3 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local testC = c or {}</span></p><p class="c7"><span class="c3 c8">end</span></p><p class="c7 c10"><span class="c6 c8"></span></p><p class="c7"><span class="c6 c8">Lua also supports </span><span class="c6 c8">ternary operator</span><span class="c6 c8">&nbsp;which allows you to construct an if and statement and return value all in one line. The statement below evaluates if</span><span class="c3 c8">&nbsp;a </span><span class="c6 c8">is equal to</span><span class="c3 c8">&nbsp;b</span><span class="c6 c8">&nbsp;if true then assign </span><span class="c3 c8">a</span><span class="c6 c8">&nbsp;to the </span><span class="c3 c8">test_variable</span><span class="c6 c8">&nbsp;or else assign</span><span class="c3 c8">&nbsp;c</span><span class="c6 c8">&nbsp;to the</span><span class="c3 c8">&nbsp;test_variable</span></p><p class="c7 c10"><span class="c6 c8"></span></p><p class="c7"><span class="c3 c8">function hello_world(a,b,c)</span></p><p class="c7"><span class="c3 c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local test_variable = (a==b) and a or c </span></p><p class="c7"><span class="c3 c8">end</span></p><div class="c24"><p class="c0"><a href="#cmnt_ref1" id="cmnt1">[a]</a><span class="c1">Okay, added Part_3_Source.rar to the drive folder. You should be able to follow the instructions from Part_3_Help in the drive to execute the Calculator on nearly any Windows machine without going through Lua, IUPLua, and LPeg library installations.</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref2" id="cmnt2">[b]</a><span class="c1">William,how about we submit it now?everything looks fine</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref3" id="cmnt3">[c]</a><span class="c1">Whoops, I fell asleep, haha. Ready to package everything?</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref4" id="cmnt4">[d]</a><span class="c1">Yeah,about the &quot;Help&quot; doc,some of the color is purple,should I change them to black?</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref5" id="cmnt5">[e]</a><span class="c1">I do not see it. All text is RGB 34, 34, 34, which is default as close to black as we use in this document.</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref6" id="cmnt6">[f]</a><span class="c1">Okay, I added a much needed part written from scratch, the objective and analysis. It gives the objective of the program and the analysis of what makes it work.</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref7" id="cmnt7">[g]</a><span class="c1">Is there anything else that needs doing for Part 3?</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref8" id="cmnt8">[h]</a><span class="c1">5. Concurrency (if your language supports it). </span></p><p class="c0"><span class="c1">I found a library that allows lua to support concurrency, should we include that?</span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">6. Any unique syntax that your language supports. </span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">Do you know if lua has any unique syntax?</span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">7. Any unique semantics that your language supports. For example, if your language supports short-circuit evaluation of booleans, allows overloading in a unique manner, etc. you should demonstrate this. </span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">Do you know any unique semantics for lua?</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref9" id="cmnt9">[i]</a><span class="c1">You can just mention that it supports it through third parties.</span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">Yeah, parentheses and semi-colons are unnecessary for the grammar of the language, similar to Ruby syntax.</span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">Yeah, functions do not need to be called with the same number of arguments as the header in the declaration does, similar to JavaScript and some other languages.</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref10" id="cmnt10">[j]</a><span class="c1">ok cool thanks</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref11" id="cmnt11">[k]</a><span class="c1">For #7, like given the following code:</span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">function testing(x)</span></p><p class="c0"><span class="c1">&nbsp; if x == nil then</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; x = &quot;X was not used&quot;</span></p><p class="c0"><span class="c1">&nbsp; end</span></p><p class="c0"><span class="c1">&nbsp; return x</span></p><p class="c0"><span class="c1">end</span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">print(testing())</span></p><p class="c0 c10"><span class="c1"></span></p><p class="c0"><span class="c1">Output:</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref12" id="cmnt12">[l]</a><span class="c1">&gt;lua -e &quot;io.stdout:setvbuf &#39;no&#39;&quot; &quot;calculator.lua&quot; </span></p><p class="c0"><span class="c1">X was not used</span></p><p class="c0"><span class="c1">&gt;Exit code: 0</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref13" id="cmnt13">[m]</a><span class="c1">Do we also have to mention the reason why we choose to do calculator?</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref14" id="cmnt14">[n]</a><span class="c1">I think so.</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref15" id="cmnt15">[o]</a><span class="c1">How about because it is a good way to illustrate the features of Lua?</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref16" id="cmnt16">[p]</a><span class="c1">That sounds good. Can you guys check to see what else are we missing? If not we can submit. I&#39;m trying to get to bed :( gotta get to work at 6AM</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref17" id="cmnt17">[q]</a><span class="c1">Looks good to me.</span></p><p class="c0"><span class="c1">You can go to sleep now..we can submit it</span></p></div><div class="c24"><p class="c0"><a href="#cmnt_ref18" id="cmnt18">[r]</a><span class="c1">&lt;3</span></p></div></body></html>